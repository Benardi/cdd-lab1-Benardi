---
title: "EDA sobre GOT x Xena (IMDB)"
subtitle: ''
author: "José Benardi de Souza Nunes"
output:
  html_notebook:
    toc: yes
    toc_float: yes
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
---

<br></br>

## Introdução

***

Vamos comparar as séries *Game of Thrones* e *Xena a Princesa Guerreira* para responder :

 * Qual das duas é mais bem avaliada pelos usuários?
    + A diferença se mantém ao longo das temporadas?
    + Existe efeito por ser começo/fim ou metade da temporada? 

***

### Conjunto de dados utilizado

> Análise exploratória de dados do [IMDB](https://www.imdb.com/)  sobre as séries Game of Thrones e Xena a Princesa Guerreira. Os dados originais e as variáveis vêm [deste repositorio](https://github.com/nazareno/imdb-series) . Lá consta a explicação de como os dados foram gerados e do significado de cada variável.

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(here)
library(plotly)
theme_set(theme_bw())
```

```{r}
episodes <- read_csv(here("data/series_from_imdb.csv"), 
                    progress = FALSE,
                    col_types = cols(.default = col_double(), 
                                     series_name = col_character(), 
                                     episode = col_character(), 
                                     url = col_character(),
                                     season = col_character())) %>% 
    filter(series_name %in% c("Game of Thrones","Xena a Princesa Guerreira")) 

episodes %>% 
    glimpse()
```

****

### Episódios da metade da temporada

>A título de tornar nossa discussão mais interessante vamos gerar uma nova informação : "Um episódio faz parte da metade da temporada?" (*middle_eps*). Um episódio é da metade da temporada se está entre os 60% dos episódios centrais de uma temporada.  

```{r}
sumario_simples <- 
    episodes %>% 
    select(season_ep,season,series_name) %>%
    group_by(series_name,season) %>% 
    summarise(n = n(),
               p20 = quantile(seq(from=1, to=n, by=1), 0.20),
               p80 = quantile(seq(from=1, to=n, by=1), 0.80))

episodes <- left_join(episodes, sumario_simples,
                      by = c("series_name", "season")) %>% 
    group_by(series_name, season) %>%
    mutate(middle_eps = (season_ep > p20) &
               (season_ep < p80)) %>% 
    ungroup()
episodes %>% 
    select(series_name, series_ep, middle_eps)
```

***

## E aí, quem se saiu melhor?


```{r, warning=FALSE, message=FALSE}
m <- list(
  b = 100,
  r = 185,
  t = 75
  )

p <- episodes %>% 
      ggplot(aes(x = series_name, y = user_rating, 
                 color=middle_eps,
                 group=episode)) + 
        geom_jitter(width = 0.3, alpha=0.7) +
        facet_wrap(~ season) +
        xlab("") +
        ylab("Votação do Usuário") +
        theme(axis.text.x = element_text(angle = 90, hjust = 1))  +
        scale_x_discrete(labels=c("GOT", "Xena")) +
        labs(color='Metade da temporada?') +
        ggtitle(paste("GOT x Xena (Temporada a Temporada)")) +
        theme_update(plot.title = element_text(hjust = -1))

ggplotly(p, tooltip = c("episode", "x","y")) %>%
  layout(autosize = F, margin = m)
```

É possível perceber que **ao longo de todas as seis temporadas** (na 5ª e 6ª temporada sendo menos unânime), quer sejam episódios do $\color{red}{\text{começo/metade da temporada}}$, quer sejam $\color{blue}{\text{do meio da temporada}}$, **Game of Thrones (GOT) tem avaliações mais altas que Xena a Princeisa Guerreira (Xena)**.  

