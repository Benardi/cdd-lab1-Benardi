---
title: "EDA Game of Thrones (GOT) and Xena the Warrior Princess"
output:
  html_notebook:
    toc: yes
    toc_float: yes
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(here)
theme_set(theme_bw())
```

Analisaremos as avaliações do IMDB das séries Game of Thrones e Xena The Warrior Princess.  

```{r}
episodes = read_csv(here("data/series_from_imdb.csv"), 
                    progress = FALSE,
                    col_types = cols(.default = col_double(), 
                                     series_name = col_character(), 
                                     episode = col_character(), 
                                     url = col_character(),
                                     season = col_character())) %>% 
           filter(series_name %in% c("Game of Thrones","Xena a Princesa Guerreira")) %>%
           glimpse()
```

## Qual das séries é mais bem avaliada no IMDB? 

```{r}
form <- function(x) c(mean = mean(x),
                      max = max(x),
                      min = min(x),
                      q1 = quantile(x, 0.25), 
                      q2 = quantile(x, 0.50),
                      q3 = quantile(x, 0.75))

episodes %>% 
          subset(select=c("user_rating", "series_name")) %>%
          aggregate(user_rating ~ series_name, ., form) %>%
          do.call(data.frame, .) %>%
          setNames(c("series_name","mean","max","min","q1","q2","q3"))
```

```{r}
episodes %>% 
    ggplot(aes(x = series_name,
               y = user_rating,
               group=series_name,
               color=series_name)) +
    geom_violin() +
    geom_boxplot(width=.1) +
    theme(axis.title.x=element_blank(),
          axis.text.x=element_blank(),
          axis.ticks.x=element_blank())
```
*  Em especial em termos de mediana GOT está bem acima com seus 8.95 contra os 7.80 de Xena.
* É possível notar que a quase totalidade das notas de GOT (min = 8.0) está pelo menos muito próxima do terceiro quartil de Xena (8.5). 
* É possível perceber que a densidade de frequência (violin-plot) das notas de GOT é  mais alta em torno de entre [8.5, 9] enquanto que a densidade de frequência das notas de Xena é mais alta entre ao redor de 8.0. 

Em termos de quartis e de densidade de frequência **a série _Game of Thrones_ é mais bem avaliada do que a série _Xena a Princesa Guerreira_ no IMBD**.  

```{r}
form <- function(x) c(mean = mean(x), sd = sd(x), n =length(x))

episodes %>% 
    aggregate(user_rating ~ series_name, ., form) %>%
    do.call(data.frame, .) %>%
    mutate(se = user_rating.sd/sqrt(user_rating.n)) %>%
    setNames(c("series_name","mean","sd","n","se")) %>% 
    ggplot(aes(series_name,mean, fill = series_name)) + 
    geom_bar(stat='identity') + 
    geom_errorbar(aes(width= 0.25,
                      ymax = mean + se,
                      ymin = mean - se)) +
    scale_fill_discrete(name = "Série") + 
    scale_y_continuous(limits = c(0,10)) +
    labs(y = "mean user_rating")
```

* Comparando a avalição média dos usúarios para Game of Thrones (9.046667) com a avaliação média de Xena (7.715672), Game of Thrones sai mais uma vez como a mais bem avaliada.

* Observando as barras de erro (erro padrão da média), relativamente pequenas e suficientemente distantes uma da outra, estas não aparentam minorar o que os valores médios apontam.   

Assim, tanto os valores médios como o gráfico, que inclui o erro médio, reforçam a afirmação de que **a série _Game of Thrones_ é mais bem avaliada que a série _Xena the Warrior Princess_ no IMBD**.  

###  Muda de acordo com as temporadas da série?

```{r}
episodes %>% 
  ggplot(aes(x = series_name, y = user_rating, fill=season)) +
    geom_boxplot(position = position_dodge(width = 0.9)) 
```

Existe uma certa mudança na distribuição dos valores quando consideramos temporadas distin

```{r}
episodes %>% 
  ggplot(aes(x = series_name,
             y = user_rating,
             color=series_name)) + 
    facet_wrap(~ season) + 
    geom_boxplot(position = position_dodge(width = 0.9)) +
    theme(axis.title.x=element_blank(),
          axis.text.x=element_blank(),
          axis.ticks.x=element_blank())
```

## Qual das séries tem episódios de qualidade mais irregular segundo o IMDB?

```{r}
episodes %>% 
  ggplot(aes(x = series_name, y = user_rating)) + 
    geom_jitter(width = 0.25) 
```

```{r}
episodes %>%
  ggplot(aes(user_rating,color=series_name)) +
    geom_density()
```

```{r}
episodes %>% 
  ggplot(aes(x = series_name,
             y = user_rating,
             color=series_name)) +
    geom_jitter(width = 0.25) +
    facet_wrap(~ season) +
    theme(axis.title.x=element_blank(),
          axis.text.x=element_blank(),
          axis.ticks.x=element_blank())
```

```{r}
episodes %>%
  ggplot(aes(user_rating,color=series_name)) +
    geom_density() +
    facet_wrap(~ season)
```

